# docker-compose.yml
version: "3.9"

services:
  web:
    build:
      context: .
      dockerfile: ./Dockerfile

    # This overrides the CMD in the Dockerfile
    command: 
      - "sh"
      - "-c"
      - |
        pip3 install --disable-pip-version-check --no-cache-dir debugpy -t /tmp && \
        python /tmp/debugpy --wait-for-client --listen 0.0.0.0:5678 \
        -m uvicorn main:app --host 0.0.0.0 --port 8000
    ports:
      - 8000:8000
      - 5678:5678
    volumes:
      - .:/app
